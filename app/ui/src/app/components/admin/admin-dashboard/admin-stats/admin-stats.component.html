<div class="container-fluid p-5">
  <h1 class="pb-2 border-bottom fw-bold text-uppercase">
    Stats
    <span style="float: right">
      <i class="bi bi-arrows-angle-expand fs-4" [routerLink]="['/admin/stats']"
      routerLinkActive="router-link-active"></i>
    </span>
  </h1>
  <div class="row row-cols-lg-4 row-cols-2">
    <div class="col py-2 px-4">
      <div class="row border border-1 border-dark userCount py-2 rounded shadow " [routerLink]="['/admin/dashboard/users']">
        <div class="col ">
          <i class="bi bi-people fs-2 " style=""></i>
        </div>
        <div class="col centerIt flex-column">
          <div class="fs-5 ">{{appStats?.userCount}}</div>
          <small class="">Users</small>
        </div>
      </div>
    </div>
    <div class="col py-2 px-4">
      <div class="row border border-1 border-dark courseCount py-2 rounded shadow" [routerLink]="['/admin/dashboard/courses/approved']">
        <div class="col">
          <i class="bi bi-book fs-2 " style=""></i>
        </div>
        <div class="col centerIt flex-column">
          <div class="fs-5 ">{{appStats?.courseCount}}</div>
          <small class="">Courses</small>
        </div>
      </div>
    </div>
    <div class="col py-2 px-4">
      <div class="row border border-1 border-dark registrationsCount py-2 rounded shadow">
        <div class="col">
          <i class="bi bi-box-arrow-down fs-2 " style=""></i>
        </div>
        <div class="col centerIt flex-column">
          <div class="fs-5 ">{{appStats?.registrationsCount}}</div>
          <small class="">Registrations</small>
        </div>
      </div>
    </div>
    <div class="col py-2 px-4">
      <div class="row border border-1 border-dark salesCount py-2 rounded shadow">
        <div class="col">
          <i class="bi bi-pie-chart fs-2 " style=""></i>
        </div>
        <div class="col centerIt flex-column">
          <div class="fs-5 ">{{appStats?.salesCount}}</div>
          <small class="">Sales</small>
        </div>
      </div>
    </div>
  </div>



 <!-- src/app/components/admin-stats/admin-stats.component.html -->

<div class="container">
  <h3 class="my-4">Payments</h3>
  
  <!-- Button to export data to Excel -->
  <button class="btn btn-primary mb-3" (click)="exportToExcel()">Export to Excel</button>

  <div class="table-responsive" style="max-height: 400px; overflow-y: auto;">
    <table class="table table-bordered table-striped">
      <thead class="thead-dark">
        <tr>
          <th>Payment ID</th>
          <th>Order ID</th>
          <th>Amount</th>
          <th>Status</th>
          <th>User Email</th>
          <th>Course Title</th>
          <th>Author</th>
          <th>Coupon Code</th>
          <th>Discount</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let payment of payments">
          <td>{{ payment.paymentId }}</td>
          <td>{{ payment.orderId }}</td>
          <td>{{ payment.amount | currency:'INR':'symbol':'1.2-2' }}</td>
          <td>{{ payment.status }}</td>
          <td>{{ payment.userName }}</td>
          <td>{{ payment.courseTitle }}</td>
          <td>{{ payment.courseAuthor }}</td>
          <td>{{ payment.couponName || 'null' }}</td>
          <td>{{ payment.percentage }}%</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

  
</div>
